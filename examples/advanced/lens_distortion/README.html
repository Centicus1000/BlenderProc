<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Camera lens distortion generation and validation &mdash; BlenderProc 2.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme_overrides.css?v=034b4ec4" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=dfec817d"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            BlenderProc
          </a>
              <div class="version">
                2.7.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../docs/tutorials/loader.html">Loading and manipulating objects</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../docs/tutorials/camera.html">Configuring the camera</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../docs/tutorials/renderer.html">Rendering the scene</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../docs/tutorials/writer.html">Writing the results to file</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../docs/tutorials/key_frames.html">How key frames work</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../docs/tutorials/physics.html">Positioning objects via the physics simulator</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../basics/README.html">Basics</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../basics/basic/README.html">basic</a></li>
<li class="toctree-l2"><a class="reference external" href="../../basics/camera_object_pose/README.html">camera_object_pose</a></li>
<li class="toctree-l2"><a class="reference external" href="../../basics/camera_sampling/README.html">camera_sampling</a></li>
<li class="toctree-l2"><a class="reference external" href="../../basics/entity_manipulation/README.html">entity_manipulation</a></li>
<li class="toctree-l2"><a class="reference external" href="../../basics/light_sampling/README.html">light_sampling</a></li>
<li class="toctree-l2"><a class="reference external" href="../../basics/material_manipulation/README.html">material_manipulation</a></li>
<li class="toctree-l2"><a class="reference external" href="../../basics/physics_positioning/README.html">physics_positioning</a></li>
<li class="toctree-l2"><a class="reference external" href="../../basics/semantic_segmentation/README.html">semantic_segmentation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 current"><a class="reference external" href="../README.html">Advanced</a><ul>
<li class="toctree-l2"><a class="reference external" href="../auto_shading/README.html">auto_shading</a></li>
<li class="toctree-l2"><a class="reference external" href="../calibration/README.html">calibration</a></li>
<li class="toctree-l2"><a class="reference external" href="../camera_depth_of_field/README.html">camera_depth_of_field</a></li>
<li class="toctree-l2"><a class="reference external" href="../camera_random_trajectories/README.html">camera_random_trajectories</a></li>
<li class="toctree-l2"><a class="reference external" href="../coco_annotations/README.html">coco_annotations</a></li>
<li class="toctree-l2"><a class="reference external" href="../diffuse_color_image/README.html">diffuse_color_image</a></li>
<li class="toctree-l2"><a class="reference external" href="../dust/README.html">dust</a></li>
<li class="toctree-l2"><a class="reference external" href="../entity_displacement_modifier/README.html">entity_displacement_modifier</a></li>
<li class="toctree-l2"><a class="reference external" href="../gif_animation/README.html">gif_animation</a></li>
<li class="toctree-l2"><a class="reference external" href="../kinect_azure_noise/README.html">kinect_azure_noise</a></li>
<li class="toctree-l2"><a class="reference external" href="#">lens_distortion</a></li>
<li class="toctree-l2"><a class="reference external" href="../material_randomizer/README.html">material_randomizer</a></li>
<li class="toctree-l2"><a class="reference external" href="../motion_blur_rolling_shutter/README.html">motion_blur_rolling_shutter</a></li>
<li class="toctree-l2"><a class="reference external" href="../multi_render/README.html">multi_render</a></li>
<li class="toctree-l2"><a class="reference external" href="../nocs/README.html">nocs</a></li>
<li class="toctree-l2"><a class="reference external" href="../object_pose_sampling/README.html">object_pose_sampling</a></li>
<li class="toctree-l2"><a class="reference external" href="../on_surface_object_sampling/README.html">on_surface_object_sampling</a></li>
<li class="toctree-l2"><a class="reference external" href="../optical_flow/README.html">optical_flow</a></li>
<li class="toctree-l2"><a class="reference external" href="../physics_convex_decomposition/README.html">physics_convex_decomposition</a></li>
<li class="toctree-l2"><a class="reference external" href="../point_clouds/README.html">point_clouds</a></li>
<li class="toctree-l2"><a class="reference external" href="../random_backgrounds/README.html">random_backgrounds</a></li>
<li class="toctree-l2"><a class="reference external" href="../random_room_constructor/README.html">random_room_constructor</a></li>
<li class="toctree-l2"><a class="reference external" href="../spotlight/README.html">spotlight</a></li>
<li class="toctree-l2"><a class="reference external" href="../stereo_matching/README.html">stereo_matching</a></li>
<li class="toctree-l2"><a class="reference external" href="../stereo_matching_with_projector/README.html">stereo_matching_with_projector</a></li>
<li class="toctree-l2"><a class="reference external" href="../urdf_loading_and_manipulation/README.html">urdf_loading_and_manipulation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../datasets/README.html">Datasets</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../datasets/amass_human_poses/README.html">amass_human_poses</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/blenderkit/README.html">blenderkit</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/bop_challenge/README.html">bop_challenge</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/bop_object_on_surface_sampling/README.html">bop_object_on_surface_sampling</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/bop_object_physics_positioning/README.html">bop_object_physics_positioning</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/bop_object_pose_sampling/README.html">bop_object_pose_sampling</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/bop_scene_replication/README.html">bop_scene_replication</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/front_3d/README.html">front_3d</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/front_3d_object_sampling/README.html">front_3d_object_sampling</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/front_3d_with_improved_mat/README.html">front_3d_with_improved_mat</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/haven/README.html">haven</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/ikea/README.html">ikea</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/matterport3d/README.html">matterport3d</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/pix3d/README.html">pix3d</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/replica/README.html">replica</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/scenenet/README.html">scenenet</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/scenenet_with_cctextures/README.html">scenenet_with_cctextures</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/shapenet/README.html">shapenet</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/shapenet_with_scenenet/README.html">shapenet_with_scenenet</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/shapenet_with_suncg/README.html">shapenet_with_suncg</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/suncg_basic/README.html">suncg_basic</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/suncg_with_cam_sampling/README.html">suncg_with_cam_sampling</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/suncg_with_improved_mat/README.html">suncg_with_improved_mat</a></li>
<li class="toctree-l2"><a class="reference external" href="../../datasets/suncg_with_object_replacer/README.html">suncg_with_object_replacer</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Entities (bproc.types)</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.ArmatureUtility.html#blenderproc.python.types.ArmatureUtility.Armature">Armature</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.EntityUtility.html#blenderproc.python.types.EntityUtility.Entity">Entity</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.LightUtility.html#blenderproc.python.types.LightUtility.Light">Light</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.MaterialUtility.html#blenderproc.python.types.MaterialUtility.Material">Material</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.MeshObjectUtility.html#blenderproc.python.types.MeshObjectUtility.MeshObject">MeshObject</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.StructUtility.html#blenderproc.python.types.StructUtility.Struct">Struct</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.URDFUtility.html#blenderproc.python.types.URDFUtility.URDFObject">URDFObject</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.InertialUtility.html#blenderproc.python.types.InertialUtility.Inertial">Inertial</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.LinkUtility.html#blenderproc.python.types.LinkUtility.Link">Link</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Api</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.camera.html#module-blenderproc.camera">bproc.camera</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.constructor.html#module-blenderproc.constructor">bproc.constructor</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.filter.html#module-blenderproc.filter">bproc.filter</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.lighting.html#module-blenderproc.lighting">bproc.lighting</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.loader.html#module-blenderproc.loader">bproc.loader</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.material.html#module-blenderproc.material">bproc.material</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.math.html#module-blenderproc.math">bproc.math</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.object.html#module-blenderproc.object">bproc.object</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.postprocessing.html#module-blenderproc.postprocessing">bproc.postprocessing</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.renderer.html#module-blenderproc.renderer">bproc.renderer</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.sampler.html#module-blenderproc.sampler">bproc.sampler</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.types.html#module-blenderproc.types">bproc.types</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.utility.html#module-blenderproc.utility">bproc.utility</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.world.html#module-blenderproc.world">bproc.world</a></li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.api.writer.html#module-blenderproc.writer">bproc.writer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Internal</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.sampler.html">bproc.python.sampler</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.sampler.Front3DPointInRoomSampler.html#blenderproc.python.sampler.Front3DPointInRoomSampler.Front3DPointInRoomSampler">Front3DPointInRoomSampler</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.sampler.ReplicaPointInRoomSampler.html#blenderproc.python.sampler.ReplicaPointInRoomSampler.ReplicaPointInRoomSampler">ReplicaPointInRoomSampler</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.sampler.SuncgPointInRoomSampler.html#blenderproc.python.sampler.SuncgPointInRoomSampler.SuncgPointInRoomSampler">SuncgPointInRoomSampler</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.sampler.Disk.html#blenderproc.python.sampler.Disk._Disk">_Disk</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.sampler.UniformSO3.html#blenderproc.python.sampler.UniformSO3._UniformSO3">_UniformSO3</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.sampler.UpperRegionSampler.html#blenderproc.python.sampler.UpperRegionSampler.Region2D">Region2D</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.types.html">bproc.python.types</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.ArmatureUtility.html#blenderproc.python.types.ArmatureUtility.Armature">Armature</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.EntityUtility.html#blenderproc.python.types.EntityUtility.Entity">Entity</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.LightUtility.html#blenderproc.python.types.LightUtility.Light">Light</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.MaterialUtility.html#blenderproc.python.types.MaterialUtility.Material">Material</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.MeshObjectUtility.html#blenderproc.python.types.MeshObjectUtility.MeshObject">MeshObject</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.StructUtility.html#blenderproc.python.types.StructUtility.Struct">Struct</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.URDFUtility.html#blenderproc.python.types.URDFUtility.URDFObject">URDFObject</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.InertialUtility.html#blenderproc.python.types.InertialUtility.Inertial">Inertial</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.types.LinkUtility.html#blenderproc.python.types.LinkUtility.Link">Link</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.utility.html">bproc.python.utility</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.Utility.html#blenderproc.python.utility.Utility.BlockStopWatch">BlockStopWatch</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.LabelIdMapping.html#blenderproc.python.utility.LabelIdMapping.LabelIdMapping">LabelIdMapping</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.Utility.html#blenderproc.python.utility.Utility.UndoAfterExecution">UndoAfterExecution</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.CollisionUtility.html#blenderproc.python.utility.CollisionUtility.CollisionUtility">CollisionUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.DefaultConfig.html#blenderproc.python.utility.DefaultConfig.DefaultConfig">DefaultConfig</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.GlobalStorage.html#blenderproc.python.utility.GlobalStorage.GlobalStorage">GlobalStorage</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.Initializer.html#blenderproc.python.utility.Initializer._Initializer">_Initializer</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.InstallUtility.html#blenderproc.python.utility.InstallUtility.InstallUtility">InstallUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.MaterialGetter.html#blenderproc.python.utility.MaterialGetter.MaterialGetter">MaterialGetter</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.MathUtility.html#blenderproc.python.utility.MathUtility.MathUtility">MathUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.SetupUtility.html#blenderproc.python.utility.SetupUtility.SetupUtility">SetupUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.Utility.html#blenderproc.python.utility.Utility.KeyFrame">KeyFrame</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.Utility.html#blenderproc.python.utility.Utility.NumpyEncoder">NumpyEncoder</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.Utility.html#blenderproc.python.utility.Utility.Utility">Utility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.utility.Utility.html#blenderproc.python.utility.Utility._KeyFrameState">_KeyFrameState</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.filter.html">bproc.python.filter</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.filter.Filter.html#blenderproc.python.filter.Filter._Filter">_Filter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.lighting.html">bproc.python.lighting</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.lighting.SuncgLighting.html#blenderproc.python.lighting.SuncgLighting._SuncgLighting">_SuncgLighting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.loader.html">bproc.python.loader</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.AMASSLoader.html#blenderproc.python.loader.AMASSLoader._AMASSLoader">_AMASSLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.BlendLoader.html#blenderproc.python.loader.BlendLoader._BlendLoader">_BlendLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.BopLoader.html#blenderproc.python.loader.BopLoader._BopLoader">_BopLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.CCMaterialLoader.html#blenderproc.python.loader.CCMaterialLoader._CCMaterialLoader">_CCMaterialLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.Front3DLoader.html#blenderproc.python.loader.Front3DLoader._Front3DLoader">_Front3DLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.HavenMaterialLoader.html#blenderproc.python.loader.HavenMaterialLoader.HavenMaterialLoader">HavenMaterialLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.IKEALoader.html#blenderproc.python.loader.IKEALoader._IKEALoader">_IKEALoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.Pix3DLoader.html#blenderproc.python.loader.Pix3DLoader._Pix3DLoader">_Pix3DLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.RockEssentialsRockLoader.html#blenderproc.python.loader.RockEssentialsRockLoader.RockEssentialsRockLoader">RockEssentialsRockLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.SceneNetLoader.html#blenderproc.python.loader.SceneNetLoader._SceneNetLoader">_SceneNetLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.ShapeNetLoader.html#blenderproc.python.loader.ShapeNetLoader._ShapeNetLoader">_ShapeNetLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.SuncgLoader.html#blenderproc.python.loader.SuncgLoader._SuncgLoader">_SuncgLoader</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.loader.TextureLoader.html#blenderproc.python.loader.TextureLoader._TextureLoader">_TextureLoader</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.object.html">bproc.python.object</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.object.FaceSlicer.html#blenderproc.python.object.FaceSlicer.FaceSlicer">FaceSlicer</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.object.ObjectReplacer.html#blenderproc.python.object.ObjectReplacer._ObjectReplacer">_ObjectReplacer</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.object.OnSurfaceSampler.html#blenderproc.python.object.OnSurfaceSampler._OnSurfaceSampler">_OnSurfaceSampler</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.object.PhysicsSimulation.html#blenderproc.python.object.PhysicsSimulation._PhysicsSimulation">_PhysicsSimulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.postprocessing.html">bproc.python.postprocessing</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.postprocessing.PostProcessingUtility.html#blenderproc.python.postprocessing.PostProcessingUtility._PostProcessingUtility">_PostProcessingUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.postprocessing.StereoGlobalMatching.html#blenderproc.python.postprocessing.StereoGlobalMatching._StereoGlobalMatching">_StereoGlobalMatching</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.renderer.html">bproc.python.renderer</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.renderer.FlowRendererUtility.html#blenderproc.python.renderer.FlowRendererUtility._FlowRendererUtility">_FlowRendererUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.renderer.NOCSRendererUtility.html#blenderproc.python.renderer.NOCSRendererUtility._NOCSRendererUtility">_NOCSRendererUtility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.tests.html">bproc.python.tests</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.tests.SilentMode.html#blenderproc.python.tests.SilentMode.SilentMode">SilentMode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="../../../blenderproc.python.writer.html">bproc.python.writer</a><ul>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.writer.BopWriterUtility.html#blenderproc.python.writer.BopWriterUtility._BopWriterUtility">_BopWriterUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.writer.CocoWriterUtility.html#blenderproc.python.writer.CocoWriterUtility._CocoWriterUtility">_CocoWriterUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.writer.GifWriterUtility.html#blenderproc.python.writer.GifWriterUtility._GifWriterUtility">_GifWriterUtility</a></li>
<li class="toctree-l2"><a class="reference external" href="../../../blenderproc.python.writer.WriterUtility.html#blenderproc.python.writer.WriterUtility._WriterUtility">_WriterUtility</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">BlenderProc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Camera lens distortion generation and validation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/examples/advanced/lens_distortion/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="camera-lens-distortion-generation-and-validation">
<h1>Camera lens distortion generation and validation<a class="headerlink" href="#camera-lens-distortion-generation-and-validation" title="Link to this heading"></a></h1>
<p>Generates distorted images (RGB, depth, and normals) of a typical BlenderProc virtual scene and of a precisely measured camera calibration plate at known poses and intrinsics. The latter will be used for validation of our geometric camera model by comparing the generated images to real images.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<p>Execute in the BlenderProc main directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">blenderproc</span> <span class="n">run</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">examples</span><span class="o">/</span><span class="n">resources</span><span class="o">/</span><span class="n">scene</span><span class="o">.</span><span class="n">obj</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">output</span>
</pre></div>
</div>
<p>for the standard scene:</p>
<a class="reference external image-reference" href="../../../images/lens_img0_generated.png"><img alt="" src="../../../_images/lens_img0_generated.png" /></a>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">blenderproc</span> <span class="n">run</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">main_callab</span><span class="o">.</span><span class="n">py</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">callab_platte</span><span class="o">.</span><span class="n">obj</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">camera_calibration_callab_img1</span><span class="o">.</span><span class="n">cal</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">output</span>
</pre></div>
</div>
<p>for a simple calibration image by loading intrinsics and extrinsics from a file:</p>
<a class="reference external image-reference" href="../../../images/lens_img1_generated.png"><img alt="" src="../../../_images/lens_img1_generated.png" /></a>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">blenderproc</span> <span class="n">run</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">main_callab</span><span class="o">.</span><span class="n">py</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">callab_platte_justin</span><span class="o">.</span><span class="n">obj</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">camera_calibration_callab_img2</span><span class="o">.</span><span class="n">cal</span> <span class="n">examples</span><span class="o">/</span><span class="n">advanced</span><span class="o">/</span><span class="n">lens_distortion</span><span class="o">/</span><span class="n">output</span>
</pre></div>
</div>
<p>for a fairly distorted image:</p>
<a class="reference external image-reference" href="../../../images/lens_img2_generated.png"><img alt="" src="../../../_images/lens_img2_generated.png" /></a>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">output</span></code> folder will contain hdf5 files including distorted color, depth, and normal images. Use <code class="docutils literal notranslate"><span class="pre">./blenderproc/scripts/saveAsImg.py</span></code> or <code class="docutils literal notranslate"><span class="pre">blenderproc</span> <span class="pre">extract</span> <span class="pre">hdf5</span></code> to unpack.</p>
</section>
<section id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Link to this heading"></a></h2>
<p>Compare the above images with the real images in <code class="docutils literal notranslate"><span class="pre">./images/lens*real*</span></code> for geometric validation:</p>
<a class="reference external image-reference" href="../../../images/lens_img1.gif"><img alt="" src="../../../_images/lens_img1.gif" /></a>
<a class="reference external image-reference" href="../../../images/lens_img2.gif"><img alt="" src="../../../_images/lens_img2.gif" /></a>
</section>
<section id="steps">
<h2>Steps<a class="headerlink" href="#steps" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Loads objects; locates them at the origin of the world ref. frame</p></li>
<li><p>Creates a point light</p></li>
<li><p>Sets the camera intrinsics including the lens distortion parameters</p></li>
<li><p>Intializes the undistorted-to-distorted coordinates mapping for all generated undistorted images (typically in a higher resolution than desired) to be eventually distorted</p></li>
<li><p>Either samples camera-to-object poses (first example) or loads the camera poses measured with a camera calibration software (e.g., <a class="reference external" href="https://www.robotic.de/callab">DLR CalLab v1</a>)</p></li>
<li><p>Renders RGB, depth and, normals</p></li>
<li><p>Applies lens distortion (to the temporal, higher-resoluted, intermediate Blender images, and then cropes them down to the desired resolution)</p></li>
<li><p>Writes the distorted data to a .hdf5 container</p></li>
<li><p>Test by comparing the generated images with the reference real images <code class="docutils literal notranslate"><span class="pre">./images/lens_img1_real.jpg</span></code> and <code class="docutils literal notranslate"><span class="pre">./images/lens_img2_real.png</span></code></p></li>
</ul>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Link to this heading"></a></h2>
<section id="object-loader">
<h3>Object loader<a class="headerlink" href="#object-loader" title="Link to this heading"></a></h3>
<p>This comes by argument and accepts both <code class="docutils literal notranslate"><span class="pre">.obj</span></code> (+<code class="docutils literal notranslate"><span class="pre">.mtl</span></code>) and <code class="docutils literal notranslate"><span class="pre">.blend</span></code> files. The <code class="docutils literal notranslate"><span class="pre">.blend</span></code> files included in the directory show the BlenderProc2 logo as in the GIF images above. The object models are expected in metric scale.</p>
</section>
<section id="set-camera-intrinsics-manually-and-setup-lens-distortion">
<h3>Set camera intrinsics manually and setup lens distortion<a class="headerlink" href="#set-camera-intrinsics-manually-and-setup-lens-distortion" title="Link to this heading"></a></h3>
<p>You can specify the camera intrinsics (following the pinhole camera model but with skew=0 always) including the undistorted-to-distorted Brown-Conrady lens distortion model in the <code class="docutils literal notranslate"><span class="pre">.py</span></code> config file. We discourage the use of the parameters <code class="docutils literal notranslate"><span class="pre">k3</span></code>,<code class="docutils literal notranslate"><span class="pre">p1</span></code>,<code class="docutils literal notranslate"><span class="pre">p2</span></code> since they are virtually never needed and they may compromise the distorted-to-undistorted mapping at the corner pixels of the image. This model is widespread in computer vision (e.g., OpenCV, DLR CalLab, Kalibr, Bouguet).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">resolution_x</span><span class="p">,</span> <span class="n">resolution_y</span> <span class="o">=</span> <span class="mi">1336</span><span class="p">,</span> <span class="mi">1000</span>
<span class="n">cam_K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">774.189</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span> <span class="mf">665.865</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">774.189</span><span class="p">,</span> <span class="mf">498.651</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.249855</span><span class="p">,</span> <span class="mf">0.102193</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0210435</span>
<span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
<span class="n">bproc</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">set_intrinsics_from_K_matrix</span><span class="p">(</span><span class="n">cam_K</span><span class="p">,</span> <span class="n">resolution_x</span><span class="p">,</span> <span class="n">resolution_y</span><span class="p">,</span>
<span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">clip_start</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">clip_end</span><span class="p">)</span>
</pre></div>
</div>
<p>Subsequently, the lens distortion mapping is computed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mapping_coords</span><span class="p">,</span> <span class="n">orig_img_res</span> <span class="o">=</span> <span class="n">bproc</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">set_lens_distortion</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">,</span> <span class="n">k3</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we setup the lens distortion and adapt intrinsics so that it can be later applied in the PostProcessing. Mapping coordinates between the distorted and undistorted image as well as the original image resolution are saved and need to be applied in the actual lens distortion step done in postprocessing.</p>
</section>
<section id="alternatively-set-camera-intrinsics-from-file">
<h3>Alternatively: Set camera intrinsics from file<a class="headerlink" href="#alternatively-set-camera-intrinsics-from-file" title="Link to this heading"></a></h3>
<p>You can instead locate all these data within a text file following the DLR-RMC camera calibration file format (e.g., <code class="docutils literal notranslate"><span class="pre">camera_calibration_callab_img1.cal</span></code> as an argument to the <code class="docutils literal notranslate"><span class="pre">.py</span></code> config file). Then you can read, set the parameters, setup the distortion mapping, and even setting a camera pose using this line of code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">orig_res_x</span><span class="p">,</span> <span class="n">orig_res_y</span><span class="p">,</span> <span class="n">mapping_coords</span> <span class="o">=</span> <span class="n">bproc</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">set_camera_parameters_from_config_file</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">config_file</span><span class="p">,</span> <span class="n">read_the_extrinsics</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="camera-pose">
<h3>Camera pose<a class="headerlink" href="#camera-pose" title="Link to this heading"></a></h3>
<p>You can either sample poses for the configured scene to be in camera view (first example):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find point of interest, all cam poses should look towards it</span>
<span class="n">poi</span> <span class="o">=</span> <span class="n">bproc</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">compute_poi</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span>
<span class="c1"># Sample random camera location above objects</span>
<span class="n">location</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="c1"># Compute rotation based on vector going from location towards poi</span>
<span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">bproc</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">rotation_from_forward_vec</span><span class="p">(</span><span class="n">poi</span> <span class="o">-</span> <span class="n">location</span><span class="p">,</span> <span class="n">inplane_rot</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.7854</span><span class="p">,</span> <span class="mf">0.7854</span><span class="p">))</span>
<span class="c1"># Add homog cam pose based on location an rotation</span>
<span class="n">cam2world_matrix</span> <span class="o">=</span> <span class="n">bproc</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">build_transformation_mat</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">rotation_matrix</span><span class="p">)</span>
<span class="n">bproc</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">add_camera_pose</span><span class="p">(</span><span class="n">cam2world_matrix</span><span class="p">)</span>
</pre></div>
</div>
<p>Or input a known pose as an homog. transformation matrix from the world ref. frame to the camera ref. frame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cam2world</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(([</span><span class="mf">0.999671270370088</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00416970801689331</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0252831090758257</span><span class="p">,</span> <span class="mf">0.18543145448762</span><span class="p">],</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">0.0102301044453415</span><span class="p">,</span> <span class="mf">0.839689004789377</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.542971400435615</span><span class="p">,</span> <span class="mf">0.287115596159953</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0234939480338283</span><span class="p">,</span> <span class="mf">0.543051112648318</span><span class="p">,</span> <span class="mf">0.839370243145164</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.209347565773035</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>
<span class="n">cam2world</span> <span class="o">=</span> <span class="n">bproc</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">change_source_coordinate_frame_of_transformation_matrix</span><span class="p">(</span><span class="n">cam2world</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;-Y&quot;</span><span class="p">,</span> <span class="s2">&quot;-Z&quot;</span><span class="p">])</span>
<span class="n">bproc</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">add_camera_pose</span><span class="p">(</span><span class="n">cam2world</span><span class="p">)</span>
</pre></div>
</div>
<p>Note here the required change in the definition of the camera ref. frame from the OpenGL definition to the standard computer vision (OpenCV) definition featuring the Z axis to the front, the Y to the bottom, and the X to the right.</p>
<p>Alternatively, you can skip this step by setting <code class="docutils literal notranslate"><span class="pre">read_the_extrinsics=True</span></code> when reading data from a DLR-RMC camera calibration file.</p>
</section>
<section id="apply-lens-distortion">
<h3>Apply lens distortion<a class="headerlink" href="#apply-lens-distortion" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># post process the data and apply the lens distortion</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;normals&#39;</span><span class="p">]:</span>
    <span class="c1"># use_interpolation should be false, for everything except colors</span>
    <span class="n">use_interpolation</span> <span class="o">=</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;colors&quot;</span>
    <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">bproc</span><span class="o">.</span><span class="n">postprocessing</span><span class="o">.</span><span class="n">apply_lens_distortion</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">mapping_coords</span><span class="p">,</span> <span class="n">orig_res_x</span><span class="p">,</span> <span class="n">orig_res_y</span><span class="p">,</span>
                                                           <span class="n">use_interpolation</span><span class="o">=</span><span class="n">use_interpolation</span><span class="p">)</span>
</pre></div>
</div>
<p>For all generated image outputs (this would also include segmentation if generated) we now apply the mapping coordinates to distort the rendered image and crop it back to the original resolution.</p>
</section>
<section id="test-w-r-t-real-images">
<h3>Test w.r.t. real images<a class="headerlink" href="#test-w-r-t-real-images" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># test: compare generated image with real image</span>
<span class="k">if</span> <span class="s2">&quot;img1&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">config_file</span><span class="p">):</span>
    <span class="n">real_path</span> <span class="o">=</span> <span class="s2">&quot;./images/lens_img1_real.jpg&quot;</span>
    <span class="n">norm_corr_limit</span> <span class="o">=</span> <span class="mf">0.660</span> <span class="c1"># low since the real background is large and different</span>
<span class="k">elif</span> <span class="s2">&quot;img2&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">config_file</span><span class="p">):</span>
    <span class="n">real_path</span> <span class="o">=</span> <span class="s2">&quot;./images/lens_img2_real.png&quot;</span>
    <span class="n">norm_corr_limit</span> <span class="o">=</span> <span class="mf">0.890</span> <span class="c1"># less background</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Reference real image not found.&quot;</span><span class="p">)</span>
<span class="n">img_gene</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;colors&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">))</span>
<span class="n">img_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">real_path</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">img_gene</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">img_real</span><span class="o">.</span><span class="n">shape</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">match_template</span><span class="p">(</span><span class="n">img_gene</span><span class="p">,</span> <span class="n">img_real</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">pad_input</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span><span class="o">==</span><span class="mi">24</span><span class="p">:</span> <span class="c1"># center of the (7,7) correlation window</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The generated image is not biased w.r.t. the reference real image.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">&gt;</span><span class="n">norm_corr_limit</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The norm. correlation index between generated and real images is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">, which is fine.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The norm. correlation index between generated and real image is too low. The images do not match. Choose other object or config file.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The generated calibration pattern image and the reference real image do not match. Choose other object or config file.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We apply normalized 2-D cross-correlation between the generated image and a reference real image (either <code class="docutils literal notranslate"><span class="pre">./images/lens_img1_real.jpg</span></code> or <code class="docutils literal notranslate"><span class="pre">./images/lens_img2_real.png</span></code>). Of course, the image background beyond the calibration plate is not modeled and differs, yet the strong pattern of the calibration plate dominates such that:</p>
<ol class="arabic simple">
<li><p>any pixel shift must worsen the cross-correlation result (i.e., its maximum must lie at the kernel center)</p></li>
<li><p>their norm. cross-correlation value must reach at least the empiric value <code class="docutils literal notranslate"><span class="pre">0.660</span></code> or <code class="docutils literal notranslate"><span class="pre">0.890</span></code> for img1 or img2, resp. (they are weakened by the unmodeled background, hence &lt;1)</p></li>
</ol>
<p>If the test fails, either the wrong object model or calibration file has been used, or a bug appeared in the used BlenderProc version.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, DLR RMC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>